import{_ as n,e as a}from"./app.530372a1.js";const s={},e=a(`<h1 id="docker-\u642D\u5EFAcanal" tabindex="-1"><a class="header-anchor" href="#docker-\u642D\u5EFAcanal" aria-hidden="true">#</a> docker \u642D\u5EFAcanal</h1><h2 id="\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#\u51C6\u5907" aria-hidden="true">#</a> \u51C6\u5907</h2><h3 id="\u5BF9\u4E8E\u81EA\u5EFA-mysql-\u9700\u8981\u5148\u5F00\u542F-binlog-\u5199\u5165\u529F\u80FD-\u914D\u7F6E-binlog-format-\u4E3A-row-\u6A21\u5F0F-my-cnf-\u4E2D\u914D\u7F6E\u5982\u4E0B" tabindex="-1"><a class="header-anchor" href="#\u5BF9\u4E8E\u81EA\u5EFA-mysql-\u9700\u8981\u5148\u5F00\u542F-binlog-\u5199\u5165\u529F\u80FD-\u914D\u7F6E-binlog-format-\u4E3A-row-\u6A21\u5F0F-my-cnf-\u4E2D\u914D\u7F6E\u5982\u4E0B" aria-hidden="true">#</a> \u5BF9\u4E8E\u81EA\u5EFA MySQL , \u9700\u8981\u5148\u5F00\u542F Binlog \u5199\u5165\u529F\u80FD\uFF0C\u914D\u7F6E binlog-format \u4E3A ROW \u6A21\u5F0F\uFF0Cmy.cnf \u4E2D\u914D\u7F6E\u5982\u4E0B</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
log-bin<span class="token operator">=</span>mysql-bin <span class="token comment"># \u5F00\u542F binlog</span>
binlog-format<span class="token operator">=</span>ROW <span class="token comment"># \u9009\u62E9 ROW \u6A21\u5F0F</span>
<span class="token assign-left variable">server_id</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment"># \u914D\u7F6E MySQL replaction \u9700\u8981\u5B9A\u4E49\uFF0C\u4E0D\u8981\u548C canal \u7684 slaveId \u91CD\u590D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="\u6CE8\u610F-\u9488\u5BF9\u963F\u91CC\u4E91-rds-for-mysql-\u9ED8\u8BA4\u6253\u5F00\u4E86-binlog-\u5E76\u4E14\u8D26\u53F7\u9ED8\u8BA4\u5177\u6709-binlog-dump-\u6743\u9650-\u4E0D\u9700\u8981\u4EFB\u4F55\u6743\u9650\u6216\u8005-binlog-\u8BBE\u7F6E-\u53EF\u4EE5\u76F4\u63A5\u8DF3\u8FC7\u8FD9\u4E00\u6B65" tabindex="-1"><a class="header-anchor" href="#\u6CE8\u610F-\u9488\u5BF9\u963F\u91CC\u4E91-rds-for-mysql-\u9ED8\u8BA4\u6253\u5F00\u4E86-binlog-\u5E76\u4E14\u8D26\u53F7\u9ED8\u8BA4\u5177\u6709-binlog-dump-\u6743\u9650-\u4E0D\u9700\u8981\u4EFB\u4F55\u6743\u9650\u6216\u8005-binlog-\u8BBE\u7F6E-\u53EF\u4EE5\u76F4\u63A5\u8DF3\u8FC7\u8FD9\u4E00\u6B65" aria-hidden="true">#</a> \u6CE8\u610F\uFF1A\u9488\u5BF9\u963F\u91CC\u4E91 RDS for MySQL , \u9ED8\u8BA4\u6253\u5F00\u4E86 binlog , \u5E76\u4E14\u8D26\u53F7\u9ED8\u8BA4\u5177\u6709 binlog dump \u6743\u9650 , \u4E0D\u9700\u8981\u4EFB\u4F55\u6743\u9650\u6216\u8005 binlog \u8BBE\u7F6E,\u53EF\u4EE5\u76F4\u63A5\u8DF3\u8FC7\u8FD9\u4E00\u6B65</h4><h3 id="\u6388\u6743-canal-\u94FE\u63A5-mysql-\u8D26\u53F7\u5177\u6709\u4F5C\u4E3A-mysql-slave-\u7684\u6743\u9650-\u5982\u679C\u5DF2\u6709\u8D26\u6237\u53EF\u76F4\u63A5-grant" tabindex="-1"><a class="header-anchor" href="#\u6388\u6743-canal-\u94FE\u63A5-mysql-\u8D26\u53F7\u5177\u6709\u4F5C\u4E3A-mysql-slave-\u7684\u6743\u9650-\u5982\u679C\u5DF2\u6709\u8D26\u6237\u53EF\u76F4\u63A5-grant" aria-hidden="true">#</a> \u6388\u6743 canal \u94FE\u63A5 MySQL \u8D26\u53F7\u5177\u6709\u4F5C\u4E3A MySQL slave \u7684\u6743\u9650, \u5982\u679C\u5DF2\u6709\u8D26\u6237\u53EF\u76F4\u63A5 grant</h3><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">USER</span> canal IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;canal&#39;</span><span class="token punctuation">;</span>  
<span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">,</span> <span class="token keyword">REPLICATION</span> SLAVE<span class="token punctuation">,</span> <span class="token keyword">REPLICATION</span> CLIENT <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">&#39;canal&#39;</span><span class="token variable">@&#39;%&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- GRANT ALL PRIVILEGES ON *.* TO &#39;canal&#39;@&#39;%&#39; ;</span>
FLUSH <span class="token keyword">PRIVILEGES</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="\u62C9\u53D6\u955C\u50CF" tabindex="-1"><a class="header-anchor" href="#\u62C9\u53D6\u955C\u50CF" aria-hidden="true">#</a> \u62C9\u53D6\u955C\u50CF</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull canal/canal-server:v1.1.6
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u7B2C\u4E00\u6B21\u8FD0\u884C\u955C\u50CF" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E00\u6B21\u8FD0\u884C\u955C\u50CF" aria-hidden="true">#</a> \u7B2C\u4E00\u6B21\u8FD0\u884C\u955C\u50CF</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run -itd -h <span class="token number">0</span> --name<span class="token operator">=</span>cs --net<span class="token operator">=</span>host  -m 4096m canal/canal-server:v1.1.6<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="\u590D\u5236\u914D\u7F6E\u5230\u5BBF\u4E3B\u673A-\u5E76\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#\u590D\u5236\u914D\u7F6E\u5230\u5BBF\u4E3B\u673A-\u5E76\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u590D\u5236\u914D\u7F6E\u5230\u5BBF\u4E3B\u673A,\u5E76\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token function">cp</span> cs:/home/admin/canal-server ~/data/canal-server<span class="token punctuation">;</span>

<span class="token comment"># \u914D\u7F6E\u914D\u7F6E\u6587\u4EF6\uFF0C\u4EE5rabbitmq\u4E3A\u4F8B</span>
<span class="token comment"># 1.\u9996\u5148\u8981\u4FEE\u6539canal.properties\u6587\u4EF6</span>
<span class="token comment"># tcp, kafka, rocketMQ, rabbitMQ, pulsarMQ \u4FEE\u6539\u4E3Arabbitmq </span>
canal.serverMode <span class="token operator">=</span> rabbitMQ
<span class="token comment"># \u914D\u7F6E\u4E0A\u6211\u4EEC\u7684rabbitmq\u4FE1\u606F</span>
rabbitmq.host <span class="token operator">=</span> <span class="token number">127.0</span>.0.1
rabbitmq.virtual.host <span class="token operator">=</span> /
rabbitmq.exchange <span class="token operator">=</span> canal_exchange
rabbitmq.username <span class="token operator">=</span> admin
rabbitmq.password <span class="token operator">=</span> admin
rabbitmq.deliveryMode <span class="token operator">=</span>
<span class="token comment">#2.\u518D\u4FEE\u6539instance.properties\u6587\u4EF6</span>
<span class="token comment"># \u94FE\u63A5\u6570\u636E\u5E93\u7684\u4FE1\u606F</span>
canal.instance.master.address<span class="token operator">=</span><span class="token number">127.0</span>.0.1:3306
<span class="token comment"># username/password \u94FE\u63A5\u6570\u636E\u5E93\u7684\u8D26\u53F7\u5BC6\u7801</span>
canal.instance.dbUsername<span class="token operator">=</span>root
canal.instance.dbPassword<span class="token operator">=</span>root
<span class="token comment">#mq config  \u8FD9\u91CC\u662Frabbitmq\u7684routerkey</span>
canal.mq.topic<span class="token operator">=</span>canal_key

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="\u5220\u9664\u539F\u6709\u7684\u955C\u50CF-\u91CD\u65B0\u8DD1\u5E26\u6620\u5C04\u914D\u7F6E\u7684\u955C\u50CF" tabindex="-1"><a class="header-anchor" href="#\u5220\u9664\u539F\u6709\u7684\u955C\u50CF-\u91CD\u65B0\u8DD1\u5E26\u6620\u5C04\u914D\u7F6E\u7684\u955C\u50CF" aria-hidden="true">#</a> \u5220\u9664\u539F\u6709\u7684\u955C\u50CF\uFF0C\u91CD\u65B0\u8DD1\u5E26\u6620\u5C04\u914D\u7F6E\u7684\u955C\u50CF</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token function">rm</span> -f cs<span class="token punctuation">;</span> <span class="token comment"># \u7701\u4E8B\u73A9\u6CD5</span>
<span class="token function">docker</span> stop cs<span class="token punctuation">;</span> <span class="token function">docker</span> <span class="token function">rm</span> cs<span class="token punctuation">;</span>
<span class="token comment">#\u8FD0\u884C\u5BBF\u4E3B\u673A\u7684\u914D\u7F6E</span>
<span class="token function">docker</span> run -itd -h <span class="token number">0</span> --name<span class="token operator">=</span>cs --net<span class="token operator">=</span>host -v ~/data/canal-server:/home/admin/canal-server  -m 4096m canal/canal-server:v1.1.6<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div>`,15);function r(p,l){return e}var o=n(s,[["render",r],["__file","canal.html.vue"]]);export{o as default};
